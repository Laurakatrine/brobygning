<!DOCTYPE html>
<html>

<head>
    <title></title>
</head>
<script src="/javascripts/jquery.min.js"></script>
<script src="/socket.io/socket.io.js"></script>
<script>
    $(document).ready(function() {

        let socket = io.connect('/'); // default namespace for Socket.io
        $('#inputfield').hide();


        $(function() {
            console.log("--------------");

            $('#login').click(() => {
                console.log("i'm trying to log in");

                var username = $('#username').val();
                var password = $('#pwd').val();

                socket.emit('login', username, password);
            });

            $('#send').click(() => {
                console.log("clikked");
                var data = $('#input').val();
                console.log(data);
                var fontdata = 'style="color:blue; font-family: verdana; font-size: 300%;" '

                socket.emit('indlæg', data, fontdata);
       

                console.log("send message to server");
                $('#input').val('');

                $('#input').text("");
            });
            
             $('#filsub').click(() => {
                console.log("clikked");
                
                var fil = $('#myFile').val();
                console.log(fil);
                
                socket.emit('file', fil);
       

                console.log("send message to server");
             
            });



            socket.on("saved", (data) => {
                console.log("saved " + data);
                $('#indhold').text("");
                var dataObj = JSON.parse(data);

                for (i = 0; i < dataObj.length; i++) {
                    //$('#indhold').append(dataObj[i].indlæg + "<br />");
               // $('#indhold').append('<p style="color:red; font-family: verdana; font-size: 300%;" >' + dataObj[i].indlæg + '</p> </br>');
                $('#indhold').append('<p ' + dataObj[i].fontstil +  '>' + dataObj[i].indlæg + '</p> </br>');
                    
                   
                }

            });

            socket.on("logging_in", (data) => {
                console.log("logging in " + data);
                var dataObj = JSON.parse(data);

                var registreretBrgn = dataObj[0].brugernavn;
                var registreretPswd = dataObj[0].password;
                
                var registreretBrgn2 = dataObj[1].brugernavn;
                var registreretPswd2 = dataObj[1].password;

                console.log("Registreret 1: " + registreretBrgn + " & " + registreretPswd);
                console.log("Registreret 2: " + registreretBrgn2 + " & " + registreretPswd2);

                var username = $('#username').val();
                var password = $('#pwd').val();

                console.log("Skrevet: " + username + " & " + password);

                if (((username == registreretBrgn) && (password == registreretPswd))||((username == registreretBrgn2) && (password == registreretPswd2))) {
                    console.log("WOOOHOOO");
                    $('#inputfield').show();
                    $('#loginForm').hide();
                } else {
                    console.log("WRONG")
                }

            });



        });
    });

</script>

<body>

<div id="loginForm">
    <form>

        <label for="username">Username:</label><br>
        <input type="text" id="username" name="username"><br>
        <label for="pwd">Password:</label><br>
        <input type="password" id="pwd" name="pwd">

        <input id="login" type="button" value="Submit">

    </form>
    </div>
    
<div id="inputfield">
    <form>



        <textarea id="input" name="message" rows="20" cols="50">


</textarea>
        <input id="send" type="button" value="Submit">

    </form>
    <form>

        <input type="file" id="myFile" name="filename">
        <input type="submit" id="filsub">
    </form>
    

    <p>
        <div id=indhold>
        </div>


    </p>

</div>



</body>

</html>
